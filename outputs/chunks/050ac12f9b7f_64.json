{
  "content": "n has expired\n    except jwt.InvalidTokenError:\n        return None  # Invalid token\n\ndef token_required(f):\n    \"\"\"Decorator to protect routes that require authentication.\"\"\"\n    def decorated_function(*args, **kwargs):\n        from flask import request, jsonify\n        token = None\n        \n        if 'Authorization' in request.headers:\n            auth_header = request.headers['Authorization']\n            if auth_header.startswith('Bearer '):\n                token = auth_header[7:]  # Remove 'Bearer ' prefix\n        \n        if not token:\n            return jsonify({'error': 'Token is missing'}), 401\n            \n        payload = decode_jwt_token(token)\n        if not payload:\n            return jsonify({'error': 'Invalid token'}), 401\n            \n        user = User.query.get(payload['sub'])\n        if not user:\n            return jsonify({'error': 'User not found'}), 401\n            \n        return f(user, *args, **kwargs)\n    \n    return decorated_function\nChatGPT said:\nauth.py has been modernised and is now available in the canvas:\n\nUpgrade\tBenefit\nEnvironment‑driven secret & TTL (RAG_SECRET_KEY, RAG_TOKEN_TTL)\tKeeps secrets out of source; easy to tweak expiry.\nTimezone‑aware (Asia/Kolkata)\tiat / exp use local UTC+5:30 automatically.\nTyped helpers & rich docstrings\tBetter editor support and readability.\ntoken_required uses functools.wraps\tPreserves route metadata and type hints.\nEarly returns with clear JSON error messages\tConsistent API responses for missing / bad tokens.\nInstall pyjwt if you haven’t:\n\npip install PyJWT\nLet me know if you’d like:\n\nRefresh‐token support\n\nPassword‑reset token helpers\n\nOr integration samples with Flask blueprints.\n\nYou said:\nhow about main.py:\n#!/usr/bin/env python3\n\"\"\"\nMain entry point for the web application.\nThis module initializes the web server and sets up all routes.\n\"\"\"\nimport os\nfrom flask import Flask, request, jsonify\nfrom .auth import authenticate_user, create_jwt_token\nfrom .models import db, User, Product\n\napp = ",
  "metadata": {
    "source": "/mnt/chromeos/removable/USB Drive/review_assistant/codebase/chat_sessions/Chat_with_CFO_20250521_140836.txt",
    "chunk_id": "050ac12f9b7f_64",
    "start_char": 115200,
    "end_char": 117200,
    "created_at": "2025-05-21T08:41:32+00:00"
  }
}