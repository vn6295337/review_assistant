{
  "content": " title=args.title)\n    if not prompt:\n        print(\"❌ Failed to generate prompt\")\n        return 1\n\n    output_file = save_prompt(prompt, args.output_dir)\n    if not output_file:\n        print(\"❌ Failed to save prompt\")\n        return 1\n\n    print(f\"✓ Prompt saved: {output_file}\")\n    return 0\n\n\nif __name__ == \"__main__\":\n    raise SystemExit(main())\nChatGPT said:\nWhy you’re seeing JSON fragments in the prompt\nfile_summarizer.py currently copies the entire raw chunk text into\nplain_text_summary.\nBecause some of your chunks — for example, the one that contains the\nfull_rag_workflow.sh script — start with lines that look exactly like JSON\n({ \"id\": … }), those braces get carried into the summary string.\nmcp_helper.py then concatenates those strings into the template, so the final\nprompt shows what looks like JSON even though it’s just literal text.\n\nQuick fix (minimal change)\nReplace the 4‑line block that builds plain_text_summary\nin file_summarizer.py with a version that:\n\nKeeps only the first 20 lines of the chunk (enough context).\n\nStrips any leading “```” fences or braces to avoid JSON confusion.\n\n# OLD\nplain_text_summary = (\n    f\"## Chunk {chunk_id} from {source_file} (ID: {chunk_id_str})\\\\n\\\\n\"\n    f\"{content.strip()}\"\n)\n\n# NEW\nlines = content.strip().splitlines()\npreview = \"\\n\".join(lines[:20])            # first 20 lines\npreview = preview.lstrip(\"{` \")            # strip leading { or ``` if present\n\nplain_text_summary = (\n    f\"### Chunk {chunk_id} — {os.path.basename(source_file)}\\\\n\\\\n\"\n    f\"{preview}\\\\n\\\\n…\"\n)\nThen rerun:\n\n# regenerate summaries & prompt\nbash full_rag_workflow.sh         # choose “regenerate summaries”\nYour prompt should now be pure Markdown without stray JSON.\n\nLonger‑term improvements\nArea\tEnhancement\nfile_summarizer.py\tIntegrate a real text‐rank or LLM‑based summarizer (e.g. t5-small) when you have more compute.\nmcp_helper.py\tSupport {toc} or {list} placeholders to auto‑list chunk titles.\nTemplate\tInstead of dumping full chunk text, sh",
  "metadata": {
    "source": "/mnt/chromeos/removable/USB Drive/review_assistant/codebase/chat_sessions/Chat_with_CFO_20250521_125041.txt",
    "chunk_id": "08c8870fc586_142",
    "start_char": 255600,
    "end_char": 257600,
    "created_at": "2025-05-21T07:21:40+00:00"
  }
}